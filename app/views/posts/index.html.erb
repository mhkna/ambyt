<h1 class="main-heading">Near You</h1>
<div class="new-post">
  [ <%= link_to 'Create a New Post', new_post_path %> ]
</div>

<% @posts.each do |post| %>
  <div class="link row clearfix">

    <div class="pic">
      <%= image_tag post.picture.url(:normal) %>
    </div>

    <div class="post-content">
      <h4>
        <div class="main-content">
          <%= post.content %>
        </div>
        <small class="author"><%= time_ago_in_words(post.created_at, include_seconds: true) %> by <%= post.user != nil && post.user.name != nil ? post.user.name : "anonymous" %></small>
        <%= link_to 'Show', post_path(post) %>
        <%= link_to 'Edit', edit_post_path(post) %>
        <%= link_to 'Destroy', post_path(post), method: :delete, data: { confirm: 'Are you sure?' } %>
      </h4>


      <div class="post-voting">
        <%= link_to like_post_path(post), method: :put, class: "btn btn-default btn-sm" do %>
          <span class="glyphicon glyphicon-chevron-up"></span>
        <% end %>

        <%= link_to dislike_post_path(post), method: :put, class: "btn btn-default btn-sm" do %>
          <span class="glyphicon glyphicon-chevron-down"></span>
        <% end %>

        <span class="score"><%= post.weighted_score %></span> | 
        <span class="post-location">
          <%= post.distance.round %> miles away /// TEMP(<%= post.latitude %>, <%= post.longitude %>)
        </span>
      </div>


      <div class="recent-comment-container">
        <% if post.comments.last %>
          <div class="heading">
            Recent Comments:
          </div>
          <% post.comments.last(2).each do |comment| %>
            <div class="recent-comment"><%= comment.content %></div>
          <% end %>
        <% end %>
      </div>

    </div>

  </div>
<% end %>

<%= paginate @posts %>
